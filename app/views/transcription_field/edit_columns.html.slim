=render({ :partial => '/shared/collection_tabs', :locals => { :selected => 10, :collection_id => @collection }})
div.columns
  div.maincol

    h2 =t('.edit_spreadsheet_columns')

    =form_tag transcription_field_spreadsheet_column_add_columns_path
      =hidden_field_tag(:collection_id, @collection.id)
      =hidden_field_tag(:transcription_field_id, @transcription_field.id)
      table.field_form#new-columns
        =render ({partial: 'column_form'})
        -unless @current_columns.blank?
          -@current_columns.each do |column|
            =render ({ partial: 'new_column_form', locals: {collection_id: @collection, column: column}})
        -else
          =render ({partial: 'column_form', locals: {transcription_field: @transcription_field}})
          -3.times do
            =render ({ partial: 'new_column_form', locals: {collection_id: @collection, column: nil, transcription_field: @transcription_field}})
      .toolbar.aright.fields
        .toolbar_group
          =button_tag t('.add_additional_column'), type: 'button', id: 'add-column', class: 'button fields'
          =button_tag t('.save'), name: 'save', type: 'submit', class: 'button fields'
          =link_to t('.cancel'), transcription_field_edit_fields_path(:collection_id => @collection.slug), class: 'button fields'
          =button_tag t('.done'), name: 'done', type: 'submit', class: 'button fields'

    =render({ :partial => '/shared/collection_footer' })


-content_for :javascript
  javascript:
    $(function() {
      $('#add-column').click(function(e){
        $('#new-columns').append("#{j render partial: 'new_column_form', locals: {collection_id: @collection, column: nil, transcription_field: @transcription_field}}");
      });

      $(document).on('change', '.input_type', function(){
          addOptions(this,2);
      })

      $('table#new-columns tr').each(function(){
        var optionsObj = $(this).find('td .field-options')[0];
        if (optionsObj !== undefined){
          var index = $(this).find('td .input_type')[0].options.selectedIndex;
          if (index == 2){
            $(optionsObj).prop('disabled', false);
          };
        };
      })
    });
